<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basket Jam</title>
    <link rel="icon" type="image/jpeg" href="../default.jpg">
    <link rel="stylesheet" href="../page-theme.css">
    <style>
        body {
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            overflow-y: auto;
        }

        .game-title {
            text-align: center;
            margin-bottom: 10px;
        }

        .game-title h1 {
            font-size: clamp(2rem, 5vw, 3rem);
            margin-bottom: 5px;
            color: #ff6b00;
            text-shadow: 0 0 15px rgba(255, 107, 0, 0.6);
        }

        .subtitle {
            color: #7ec8e3;
            font-size: 1.1em;
            margin: 0;
        }

        .stats-panel {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 10px;
        }

        .stat-box {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ffff;
            padding: 10px 15px;
            text-align: center;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .stat-box.highlight {
            border-color: #ff6b00;
            box-shadow: 0 0 20px rgba(255, 107, 0, 0.5);
            transform: scale(1.05);
        }

        .stat-label {
            font-size: 0.8em;
            color: #00ffff;
            margin-bottom: 3px;
            text-transform: uppercase;
        }

        .stat-value {
            font-size: 1.5em;
            color: #fff;
            font-weight: bold;
        }

        canvas {
            border: 3px solid #ff6b00;
            background: #001122;
            max-width: 95vw;
            height: auto;
            display: block;
            touch-action: none;
        }

        .controls-panel {
            display: flex;
            flex-direction: column;
            gap: 12px;
            align-items: center;
        }

        .aim-controls {
            display: grid;
            grid-template-columns: repeat(3, 50px);
            gap: 6px;
        }

        .aim-btn {
            width: 50px;
            height: 50px;
            font-size: 1.2rem;
            background: rgba(0, 255, 255, 0.2);
            border: 2px solid #00ffff;
            color: #00ffff;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.1s ease;
            touch-action: manipulation;
            user-select: none;
        }

        .aim-btn:active {
            transform: scale(0.95);
            background: rgba(255, 107, 0, 0.6);
        }

        .aim-btn.empty {
            visibility: hidden;
            cursor: default;
        }

        .power-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .power-btn {
            padding: 8px 15px;
            background: rgba(255, 107, 0, 0.3);
            border: 2px solid #ff6b00;
            color: #ff6b00;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.1s ease;
            font-weight: bold;
            touch-action: manipulation;
            user-select: none;
        }

        .power-btn:active {
            transform: scale(0.95);
        }

        .power-display {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ffff;
            padding: 8px 15px;
            border-radius: 6px;
            color: #00ffff;
            font-weight: bold;
            min-width: 110px;
            text-align: center;
            font-size: 0.9em;
        }

        .shoot-btn {
            padding: 12px 35px;
            background: rgba(255, 0, 0, 0.8);
            border: 3px solid #ff0000;
            color: #fff;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.1s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            touch-action: manipulation;
            user-select: none;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.3);
            min-height: 44px;
        }

        .shoot-btn:active {
            transform: scale(0.98);
        }

        .game-controls {
            display: flex;
            gap: 10px;
        }

        .control-btn {
            padding: 8px 16px;
            background: rgba(126, 200, 227, 0.2);
            border: 2px solid #7ec8e3;
            color: #7ec8e3;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.1s ease;
            font-weight: bold;
            touch-action: manipulation;
            user-select: none;
            min-height: 44px;
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        .instructions {
            max-width: 500px;
            text-align: center;
            margin: 15px auto 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid #00ffff;
            border-radius: 10px;
            line-height: 1.5;
            font-size: 0.95em;
        }

        .instructions strong {
            color: #ff6b00;
        }

        @media (max-width: 768px) {
            .stats-panel {
                gap: 10px;
            }

            .stat-box {
                padding: 8px 12px;
            }

            .stat-value {
                font-size: 1.3em;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
                gap: 10px;
            }

            .aim-controls {
                grid-template-columns: repeat(3, 45px);
                gap: 5px;
            }

            .aim-btn {
                width: 45px;
                height: 45px;
                font-size: 1.1rem;
            }

            .shoot-btn {
                padding: 10px 25px;
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <a href="../index.html" class="home-link">‚Üê</a>

    <div class="game-title">
        <h1>üèÄ BASKET JAM</h1>
        <p class="subtitle">Precision hoops challenge</p>
    </div>

    <div class="stats-panel">
        <div class="stat-box" id="scoreBox">
            <div class="stat-label">Score</div>
            <div class="stat-value" id="score">0</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">Shots</div>
            <div class="stat-value" id="shots">0</div>
        </div>
        <div class="stat-box" id="streakBox">
            <div class="stat-label">Streak</div>
            <div class="stat-value" id="streak">0</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">Accuracy</div>
            <div class="stat-value" id="accuracy">0%</div>
        </div>
    </div>

    <canvas id="gameCanvas" width="400" height="600"></canvas>

    <div class="controls-panel">
        <div class="aim-controls">
            <div class="aim-btn empty"></div>
            <button class="aim-btn" id="aimUp">‚Üë</button>
            <div class="aim-btn empty"></div>
            <button class="aim-btn" id="aimLeft">‚Üê</button>
            <div class="aim-btn" style="border: 2px dashed #555; color: #555; cursor: default;">‚ö¨</div>
            <button class="aim-btn" id="aimRight">‚Üí</button>
            <div class="aim-btn empty"></div>
            <button class="aim-btn" id="aimDown">‚Üì</button>
            <div class="aim-btn empty"></div>
        </div>

        <div class="power-controls">
            <button class="power-btn" id="powerDown">‚àí</button>
            <div class="power-display">
                <span>Power: </span><span id="powerValue">50</span>%
            </div>
            <button class="power-btn" id="powerUp">+</button>
        </div>

        <button class="shoot-btn" id="shootBtn">üèÄ SHOOT!</button>
    </div>

    <div class="game-controls">
        <button class="control-btn" id="pauseBtn">PAUSE</button>
        <button class="control-btn" id="resetBtn">RESET</button>
    </div>

    <div class="instructions">
        <p><strong>Aim & Shoot:</strong> Use arrow buttons to aim angle, +/‚àí to adjust power, then tap SHOOT! Direct the ball into the basket to score.</p>
        <p><strong>Scoring:</strong> 2 points per basket. Build streaks for bonus multipliers!</p>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Game state
        const game = {
            score: 0,
            shots: 0,
            streak: 0,
            angle: 45,
            power: 50,
            ballInPlay: false,
            paused: false,
            playerX: 200,
            ball: null,
            messageText: '',
            messageTime: 0
        };

        // Physics constants
        const GRAVITY = 0.5;
        const COURT_Y = 500;
        const BASKET_X = 350;
        const BASKET_Y = 120;
        const BASKET_WIDTH = 60;
        const BASKET_HEIGHT = 8;

        // DOM elements
        const elements = {
            score: document.getElementById('score'),
            shots: document.getElementById('shots'),
            streak: document.getElementById('streak'),
            accuracy: document.getElementById('accuracy'),
            powerValue: document.getElementById('powerValue'),
            scoreBox: document.getElementById('scoreBox'),
            streakBox: document.getElementById('streakBox')
        };

        // Ball object
        class Ball {
            constructor(x, y, vx, vy) {
                this.x = x;
                this.y = y;
                this.vx = vx;
                this.vy = vy;
                this.radius = 8;
                this.scored = false;
            }

            update() {
                // Apply gravity
                this.vy += GRAVITY;

                // Update position
                this.x += this.vx;
                this.y += this.vy;

                // Boundary collision (left/right)
                if (this.x - this.radius < 0) {
                    this.x = this.radius;
                    this.vx *= -0.8;
                } else if (this.x + this.radius > canvas.width) {
                    this.x = canvas.width - this.radius;
                    this.vx *= -0.8;
                }

                // Rim collision
                const rimLeft = BASKET_X - BASKET_WIDTH / 2;
                const rimRight = BASKET_X + BASKET_WIDTH / 2;
                const rimTop = BASKET_Y;
                const rimBottom = BASKET_Y + BASKET_HEIGHT;

                // Check collision with rim
                if (
                    this.x > rimLeft && this.x < rimRight &&
                    this.y > rimTop - 15 && this.y < rimBottom + 5 &&
                    this.vy > 0
                ) {
                    // Check if ball is in basket zone
                    if (this.x > rimLeft + 5 && this.x < rimRight - 5 && this.y > rimTop + 10) {
                        if (!this.scored) {
                            this.scored = true;
                            return 'scored';
                        }
                    } else {
                        // Bounce off rim
                        this.vy *= -0.6;
                        this.vx *= 0.9;
                        this.y = rimTop - 10;
                    }
                }

                // Ball goes off screen
                if (this.y > canvas.height + 100 || this.x < -50 || this.x > canvas.width + 50) {
                    return 'miss';
                }

                return 'ok';
            }

            draw() {
                ctx.fillStyle = '#ff6b00';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fill();

                ctx.strokeStyle = '#ff9600';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.stroke();
            }
        }

        function updateStats() {
            elements.score.textContent = game.score;
            elements.shots.textContent = game.shots;
            elements.streak.textContent = game.streak;
            elements.powerValue.textContent = game.power;

            const accuracy = game.shots > 0 ? Math.round((game.score / (game.shots * 2)) * 100) : 0;
            elements.accuracy.textContent = accuracy + '%';
        }

        function showMessage(text) {
            game.messageText = text;
            game.messageTime = 60; // 1 second at 60fps
        }

        function highlightStat(element) {
            element.classList.add('highlight');
            setTimeout(() => {
                element.classList.remove('highlight');
            }, 300);
        }

        function drawCourt() {
            // Background
            ctx.fillStyle = '#001122';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Court line
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(0, COURT_Y);
            ctx.lineTo(canvas.width, COURT_Y);
            ctx.stroke();

            // Backboard
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(340, 80, 8, 50);

            // Rim (hoop)
            ctx.strokeStyle = '#ff6b00';
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.moveTo(BASKET_X - BASKET_WIDTH / 2, BASKET_Y);
            ctx.lineTo(BASKET_X + BASKET_WIDTH / 2, BASKET_Y);
            ctx.stroke();

            // Net
            ctx.strokeStyle = 'rgba(200, 200, 200, 0.7)';
            ctx.lineWidth = 1;
            for (let i = 0; i < 6; i++) {
                const x = BASKET_X - BASKET_WIDTH / 2 + (i * BASKET_WIDTH / 5);
                ctx.beginPath();
                ctx.moveTo(x, BASKET_Y);
                ctx.lineTo(x + 3, BASKET_Y + 25);
                ctx.stroke();
            }

            // Player launcher
            ctx.fillStyle = '#7ec8e3';
            ctx.fillRect(game.playerX - 15, COURT_Y + 20, 30, 8);

            // Draw aim line
            if (!game.ballInPlay && !game.paused) {
                const angle = (game.angle * Math.PI) / 180;
                const power = game.power / 100;
                const vx = Math.cos(angle) * power * 12;
                const vy = -Math.sin(angle) * power * 12;

                ctx.strokeStyle = 'rgba(255, 107, 0, 0.6)';
                ctx.lineWidth = 2;
                ctx.setLineDash([4, 4]);
                ctx.beginPath();
                ctx.moveTo(game.playerX, COURT_Y + 20);

                let x = game.playerX;
                let y = COURT_Y + 20;
                for (let i = 0; i < 40; i++) {
                    x += vx * 0.8;
                    y += vy * 0.8;
                    vy += GRAVITY * 0.8;
                    if (i === 0) {
                        ctx.lineTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.stroke();
                ctx.setLineDash([]);
            }

            // Display angle and power on canvas
            if (!game.ballInPlay && !game.paused) {
                ctx.fillStyle = '#00ffff';
                ctx.font = '12px Courier Prime';
                ctx.fillText(`${Math.round(game.angle)}¬∞`, game.playerX + 20, COURT_Y + 5);
                ctx.fillText(`${game.power}%`, game.playerX + 20, COURT_Y + 20);
            }
        }

        function shootBall() {
            if (game.ballInPlay || game.paused) return;

            game.ballInPlay = true;
            game.shots++;

            const angle = (game.angle * Math.PI) / 180;
            const power = game.power / 100;
            const vx = Math.cos(angle) * power * 12;
            const vy = -Math.sin(angle) * power * 12;

            game.ball = new Ball(game.playerX, COURT_Y + 20, vx, vy);
            updateStats();
        }

        function scoreBasket() {
            const basePoints = 2;
            const streakMultiplier = Math.min(Math.floor(game.streak / 3) + 1, 5);
            const points = basePoints * streakMultiplier;

            game.score += points;
            game.streak++;

            highlightStat(elements.scoreBox);
            highlightStat(elements.streakBox);

            if (game.streak === 1) {
                showMessage(`SWISH! +${points}`);
            } else if (game.streak < 5) {
                showMessage(`STREAK ${game.streak}! +${points}`);
            } else {
                showMessage(`ON FIRE! +${points}`);
            }

            updateStats();
        }

        function missShot() {
            if (game.streak > 0) {
                showMessage('MISS!');
                game.streak = 0;
                updateStats();
            }
        }

        function adjustAngle(delta) {
            if (game.ballInPlay || game.paused) return;
            game.angle = Math.max(15, Math.min(75, game.angle + delta));
        }

        function adjustPower(delta) {
            if (game.ballInPlay || game.paused) return;
            game.power = Math.max(20, Math.min(100, game.power + delta));
        }

        function movePlayer(delta) {
            if (game.ballInPlay || game.paused) return;
            game.playerX = Math.max(30, Math.min(canvas.width - 30, game.playerX + delta));
        }

        function togglePause() {
            game.paused = !game.paused;
            showMessage(game.paused ? 'PAUSED' : 'RESUMED');
        }

        function resetGame() {
            game.score = 0;
            game.shots = 0;
            game.streak = 0;
            game.ballInPlay = false;
            game.angle = 45;
            game.power = 50;
            game.paused = false;
            game.playerX = 200;
            game.ball = null;
            showMessage('RESET!');
            updateStats();
        }

        // Event listeners
        document.getElementById('aimUp').addEventListener('click', () => adjustAngle(3));
        document.getElementById('aimDown').addEventListener('click', () => adjustAngle(-3));
        document.getElementById('aimLeft').addEventListener('click', () => movePlayer(-15));
        document.getElementById('aimRight').addEventListener('click', () => movePlayer(15));
        document.getElementById('powerUp').addEventListener('click', () => adjustPower(5));
        document.getElementById('powerDown').addEventListener('click', () => adjustPower(-5));
        document.getElementById('shootBtn').addEventListener('click', shootBall);
        document.getElementById('pauseBtn').addEventListener('click', togglePause);
        document.getElementById('resetBtn').addEventListener('click', resetGame);

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (e.key === ' ' || e.key === 'Enter') {
                e.preventDefault();
                shootBall();
            } else if (e.key === 'p' || e.key === 'P') {
                togglePause();
            } else if (e.key === 'ArrowUp' || e.key === 'w' || e.key === 'W') {
                adjustAngle(3);
            } else if (e.key === 'ArrowDown' || e.key === 's' || e.key === 'S') {
                adjustAngle(-3);
            } else if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
                movePlayer(-15);
            } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
                movePlayer(15);
            } else if (e.key === 'q' || e.key === 'Q') {
                adjustPower(-5);
            } else if (e.key === 'e' || e.key === 'E') {
                adjustPower(5);
            }
        });

        // Game loop
        function gameLoop() {
            drawCourt();

            if (game.ball && !game.paused) {
                const status = game.ball.update();

                if (status === 'scored') {
                    scoreBasket();
                    game.ball = null;
                    game.ballInPlay = false;
                } else if (status === 'miss') {
                    missShot();
                    game.ball = null;
                    game.ballInPlay = false;
                }
            }

            if (game.ball) {
                game.ball.draw();
            }

            // Draw message
            if (game.messageTime > 0) {
                const alpha = Math.min(1, game.messageTime / 15);
                ctx.fillStyle = `rgba(255, 107, 0, ${alpha * 0.8})`;
                ctx.font = 'bold 28px Courier Prime';
                ctx.textAlign = 'center';
                ctx.fillText(game.messageText, canvas.width / 2, canvas.height / 2);
                ctx.textAlign = 'left';
                game.messageTime--;
            }

            requestAnimationFrame(gameLoop);
        }

        updateStats();
        gameLoop();
    </script>
</body>
</html>
