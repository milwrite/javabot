<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zach & Cen's Amtrak Adventure</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #0a0e27;
            color: #00ff41;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
            border: 2px solid #00ff41;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: #0a0e27;
            border: 2px solid #00ff41;
            border-radius: 0;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.3), inset 0 0 20px rgba(0, 255, 65, 0.1);
            overflow: hidden;
        }

        .header {
            background: #0a0e27;
            border-bottom: 2px solid #00ff41;
            padding: 40px 20px;
            text-align: center;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
        }

        .header h1 {
            font-size: 2.5em;
            color: #00ff41;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #00ff41;
            letter-spacing: 2px;
        }

        .header .subtitle {
            font-size: 1.5em;
            color: #ff0000;
            text-shadow: 0 0 10px #ff0000;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1em;
            color: #00ffff;
            text-shadow: 0 0 5px #00ffff;
        }

        .route-visualization {
            background: #0a0e27;
            border-bottom: 2px solid #00ff41;
            padding: 40px 20px;
            overflow-x: auto;
        }

        .stops-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-width: 100%;
            padding: 20px 0;
            position: relative;
        }

        .stops-container::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: #00ff41;
            z-index: 1;
            transform: translateY(-50%);
        }

        .stop-marker {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            min-width: 120px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .stop-marker:hover {
            transform: scale(1.1);
        }

        .stop-circle {
            width: 40px;
            height: 40px;
            border: 2px solid #00ff41;
            border-radius: 50%;
            background: #0a0e27;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            font-size: 1.2em;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
        }

        .stop-marker.visited .stop-circle {
            background: #00ff41;
            color: #0a0e27;
        }

        .stop-marker.current .stop-circle {
            background: #ff0000;
            border-color: #ff0000;
            box-shadow: 0 0 15px #ff0000;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 15px #ff0000;
            }
            50% {
                box-shadow: 0 0 25px #ff0000;
            }
        }

        .stop-name {
            font-size: 0.85em;
            color: #00ffff;
            text-align: center;
            text-shadow: 0 0 5px #00ffff;
            white-space: nowrap;
        }

        .stop-distance {
            font-size: 0.75em;
            color: #ff0000;
            text-shadow: 0 0 3px #ff0000;
        }

        .main-content {
            padding: 40px 20px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        .stop-section {
            background: #0a0e27;
            border: 2px solid #00ff41;
            border-radius: 0;
            padding: 30px;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.2);
            display: none;
        }

        .stop-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stop-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid #00ff41;
        }

        .stop-header i {
            font-size: 2.5em;
            color: #ff0000;
            margin-right: 20px;
            text-shadow: 0 0 10px #ff0000;
        }

        .stop-header h2 {
            font-size: 2em;
            color: #00ff41;
            text-shadow: 0 0 10px #00ff41;
            letter-spacing: 1px;
        }

        .stop-header p {
            color: #00ffff;
            margin-top: 5px;
            text-shadow: 0 0 5px #00ffff;
        }

        .stop-description {
            font-size: 1em;
            color: #00ff41;
            margin: 20px 0;
            line-height: 1.6;
            text-shadow: 0 0 5px rgba(0, 255, 65, 0.3);
        }

        .distance-display {
            background: #0a0e27;
            border: 2px solid #ff0000;
            border-radius: 0;
            padding: 15px;
            margin: 20px 0;
            color: #ff0000;
            font-weight: bold;
            text-align: center;
            text-shadow: 0 0 10px #ff0000;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.2);
        }

        .facts-section {
            background: #0a0e27;
            border: 2px solid #00ffff;
            border-radius: 0;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.2);
        }

        .facts-section h3 {
            color: #00ffff;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            text-shadow: 0 0 10px #00ffff;
            letter-spacing: 1px;
        }

        .facts-section h3 i {
            margin-right: 10px;
        }

        .fact-item {
            padding: 10px 0;
            border-bottom: 1px solid #00ff41;
            font-size: 0.95em;
            color: #00ff41;
            text-shadow: 0 0 5px rgba(0, 255, 65, 0.3);
        }

        .fact-item:last-child {
            border-bottom: none;
        }

        .game-container {
            background: #0a0e27;
            border: 2px solid #ff0000;
            border-radius: 0;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.2);
        }

        .game-container h3 {
            color: #ff0000;
            margin-bottom: 15px;
            text-shadow: 0 0 10px #ff0000;
            letter-spacing: 1px;
        }

        .game-button {
            background: #0a0e27;
            color: #00ff41;
            border: 2px solid #00ff41;
            padding: 12px 24px;
            border-radius: 0;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 5px rgba(0, 255, 65, 0.5);
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
            letter-spacing: 1px;
        }

        .game-button:hover {
            background: #00ff41;
            color: #0a0e27;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.5);
            text-shadow: none;
        }

        .game-button:active {
            transform: scale(0.98);
        }

        .navigation-buttons {
            display: flex;
            gap: 10px;
            margin-top: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .nav-button {
            background: #0a0e27;
            color: #00ffff;
            border: 2px solid #00ffff;
            padding: 10px 20px;
            border-radius: 0;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 5px rgba(0, 255, 255, 0.5);
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.2);
            letter-spacing: 1px;
        }

        .nav-button:hover {
            background: #00ffff;
            color: #0a0e27;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
            text-shadow: none;
        }

        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .completion-message {
            background: #0a0e27;
            border: 3px solid #00ff41;
            border-radius: 0;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            display: none;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.3);
        }

        .completion-message.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .completion-message h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: #00ff41;
            text-shadow: 0 0 15px #00ff41;
            letter-spacing: 2px;
        }

        .completion-message p {
            font-size: 1.1em;
            margin-bottom: 10px;
            color: #00ffff;
            text-shadow: 0 0 10px #00ffff;
        }

        .stats-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .stat-item {
            background: #0a0e27;
            border: 2px solid #ff0000;
            padding: 20px;
            text-align: center;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.2);
        }

        .stat-value {
            font-size: 2em;
            color: #ff0000;
            font-weight: bold;
            text-shadow: 0 0 10px #ff0000;
        }

        .stat-label {
            color: #00ffff;
            margin-top: 10px;
            text-shadow: 0 0 5px #00ffff;
        }

        .memory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }

        .memory-card {
            aspect-ratio: 1;
            background: #0a0e27;
            border: 2px solid #00ff41;
            border-radius: 0;
            cursor: pointer;
            font-size: 1.5em;
            transition: all 0.3s ease;
            color: #00ff41;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 5px rgba(0, 255, 65, 0.5);
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
        }

        .memory-card:hover:not(:disabled) {
            background: #00ff41;
            color: #0a0e27;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.5);
            text-shadow: none;
        }

        .memory-card:active:not(:disabled) {
            transform: scale(0.95);
        }

        .memory-card.flipped {
            background: #ff0000;
            border-color: #ff0000;
            color: #00ff41;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
        }

        .memory-card.matched {
            background: #00ffff;
            border-color: #00ffff;
            color: #0a0e27;
            cursor: not-allowed;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }

        .quiz-question {
            margin: 15px 0;
        }

        .quiz-question p {
            font-weight: bold;
            margin-bottom: 15px;
            color: #00ff41;
            text-shadow: 0 0 5px rgba(0, 255, 65, 0.5);
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            padding: 12px 15px;
            background: #0a0e27;
            border: 2px solid #00ffff;
            border-radius: 0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95em;
            color: #00ffff;
            font-family: 'Courier New', monospace;
            text-shadow: 0 0 5px rgba(0, 255, 255, 0.3);
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.1);
        }

        .quiz-option:hover:not(:disabled) {
            background: #00ffff;
            color: #0a0e27;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
            text-shadow: none;
        }

        .quiz-option.selected {
            background: #ff0000;
            border-color: #ff0000;
            color: #00ff41;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        .quiz-option.correct {
            background: #00ff41;
            border-color: #00ff41;
            color: #0a0e27;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
        }

        .quiz-option.incorrect {
            background: #ff0000;
            border-color: #ff0000;
            color: #00ff41;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        .quiz-feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 0;
            display: none;
            font-weight: bold;
            border: 2px solid;
        }

        .quiz-feedback.show {
            display: block;
        }

        .quiz-feedback.correct {
            background: #0a0e27;
            color: #00ff41;
            border-color: #00ff41;
            text-shadow: 0 0 10px #00ff41;
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
        }

        .quiz-feedback.incorrect {
            background: #0a0e27;
            color: #ff0000;
            border-color: #ff0000;
            text-shadow: 0 0 10px #ff0000;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.2);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .header .subtitle {
                font-size: 1.2em;
            }

            .stops-container {
                flex-wrap: wrap;
                justify-content: center;
            }

            .stop-marker {
                min-width: 100px;
                margin: 10px;
            }

            .stops-container::before {
                display: none;
            }

            .memory-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .quiz-options {
                gap: 8px;
            }

            .stats-display {
                grid-template-columns: 1fr;
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-train"></i> AMTRAK JOURNEY</h1>
            <div class="subtitle">Zach & Cen's Amtrak Adventure</div>
            <p>Penn Station to Rochester | 390 Miles</p>
        </div>

        <div class="route-visualization">
            <div class="stops-container" id="stopsContainer"></div>
        </div>

        <div class="main-content">
            <div id="stopsContent"></div>
            <div id="completionContainer"></div>
        </div>
    </div>

    <script>
        const stops = [
            {
                id: 1,
                name: "Penn Station",
                city: "New York City, NY",
                icon: "fas fa-train",
                distance: 0,
                description: "Starting point of our journey at the iconic Pennsylvania Station in Manhattan, one of the busiest railway stations in the world.",
                facts: [
                    "Penn Station opened in 1910 and serves over 750,000 passengers annually",
                    "Amtrak operates over 500 daily trains from Penn Station",
                    "The current building was completed in 1968 after the original was demolished in 1963"
                ]
            },
            {
                id: 2,
                name: "Yonkers",
                city: "Yonkers, NY",
                icon: "fas fa-city",
                distance: 20,
                description: "First stop heading north along the scenic Hudson River, the third largest city in New York State."
            },
            {
                id: 3,
                name: "Hudson Valley",
                city: "Hudson Valley, NY",
                icon: "fas fa-leaf",
                distance: 50,
                description: "Beautiful region known for its scenic landscapes, apple orchards, and historic charm along the Hudson River."
            },
            {
                id: 4,
                name: "Albany",
                city: "Albany, NY",
                icon: "fas fa-capitol",
                distance: 150,
                description: "Capital of New York State, founded in 1624 by the Dutch and home to the historic State Capitol building completed in 1899."
            },
            {
                id: 5,
                name: "Syracuse",
                city: "Syracuse, NY",
                icon: "fas fa-university",
                distance: 310,
                description: "Major city home to Syracuse University, founded in 1870, and historically a major salt production center in the 19th century."
            },
            {
                id: 6,
                name: "Rochester",
                city: "Rochester, NY",
                icon: "fas fa-flag-checkered",
                distance: 390,
                description: "Final destination - the 'Flower City' known for its beautiful gardens, home to Eastman Kodak Company, and the scenic Genesee River Falls."
            }
        ];

        let currentStopIndex = 0;

        function initializeJourney() {
            renderStopsVisualization();
            renderStopsContent();
            showStop(0);
        }

        function renderStopsVisualization() {
            const container = document.getElementById('stopsContainer');
            container.innerHTML = stops.map((stop, index) => `
                <div class="stop-marker ${index === 0 ? 'visited' : ''} ${index === currentStopIndex ? 'current' : ''}" onclick="showStop(${index})">
                    <div class="stop-circle">
                        <i class="${stop.icon}"></i>
                    </div>
                    <div class="stop-name">${stop.name}</div>
                    <div class="stop-distance">${stop.distance} mi</div>
                </div>
            `).join('');
        }

        function renderStopsContent() {
            const container = document.getElementById('stopsContent');
            container.innerHTML = stops.map((stop, index) => `
                <div class="stop-section" id="stop-${index}">
                    <div class="stop-header">
                        <i class="${stop.icon}"></i>
                        <div>
                            <h2>${stop.name}</h2>
                            <p>${stop.city}</p>
                        </div>
                    </div>

                    <div class="stop-description">${stop.description}</div>

                    <div class="distance-display">
                        <i class="fas fa-train"></i> ${stop.distance} miles from Penn Station
                    </div>

                    ${stop.facts ? `
                        <div class="facts-section">
                            <h3><i class="fas fa-lightbulb"></i> DID YOU KNOW?</h3>
                            ${stop.facts.map(fact => `<div class="fact-item">• ${fact}</div>`).join('')}
                        </div>
                    ` : ''}

                    <div class="game-container" id="game-${index}"></div>

                    <div class="navigation-buttons">
                        ${index > 0 ? `<button class="nav-button" onclick="showStop(${index - 1})"><i class="fas fa-arrow-left"></i> PREVIOUS</button>` : ''}
                        ${index < stops.length - 1 ? `<button class="nav-button" onclick="showStop(${index + 1})">NEXT <i class="fas fa-arrow-right"></i></button>` : ''}
                    </div>
                </div>
            `).join('');
        }

        function showStop(index) {
            currentStopIndex = index;
            
            // Update visualization
            document.querySelectorAll('.stop-marker').forEach((marker, i) => {
                marker.classList.remove('current', 'visited');
                if (i <= index) marker.classList.add('visited');
                if (i === index) marker.classList.add('current');
            });

            // Update content
            document.querySelectorAll('.stop-section').forEach((section, i) => {
                section.classList.remove('active');
                if (i === index) section.classList.add('active');
            });

            // Initialize game for this stop
            initializeGameForStop(index);

            // Show completion message if at last stop
            if (index === stops.length - 1) {
                showCompletionMessage();
            } else {
                hideCompletionMessage();
            }
        }

        function initializeGameForStop(stopIndex) {
            const gameContainer = document.getElementById(`game-${stopIndex}`);
            
            if (stopIndex === 0) {
                gameContainer.innerHTML = `
                    <h3><i class="fas fa-gamepad"></i> MEMORY GAME</h3>
                    <p>Match the cities with their distances!</p>
                    <div class="memory-grid" id="memory-grid-0">
                        <button class="memory-card" onclick="flipCard(0, 0)"><span>?</span></button>
                        <button class="memory-card" onclick="flipCard(0, 1)"><span>?</span></button>
                        <button class="memory-card" onclick="flipCard(0, 2)"><span>?</span></button>
                        <button class="memory-card" onclick="flipCard(0, 3)"><span>?</span></button>
                        <button class="memory-card" onclick="flipCard(0, 4)"><span>?</span></button>
                        <button class="memory-card" onclick="flipCard(0, 5)"><span>?</span></button>
                        <button class="memory-card" onclick="flipCard(0, 6)"><span>?</span></button>
                        <button class="memory-card" onclick="flipCard(0, 7)"><span>?</span></button>
                    </div>
                    <button class="game-button" onclick="resetMemoryGame(0)">RESET GAME</button>
                `;
                initMemoryGame(0);
            } else if (stopIndex === 1) {
                gameContainer.innerHTML = `
                    <h3><i class="fas fa-gamepad"></i> QUIZ TIME</h3>
                    <div class="quiz-question">
                        <p>What is the length of the Hudson River?</p>
                        <div class="quiz-options">
                            <button class="quiz-option" onclick="selectQuizAnswer(1, 0)">206 miles</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(1, 1)">315 miles</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(1, 2)">425 miles</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(1, 3)">550 miles</button>
                        </div>
                        <div class="quiz-feedback" id="feedback-1"></div>
                    </div>
                `;
            } else if (stopIndex === 2) {
                gameContainer.innerHTML = `
                    <h3><i class="fas fa-gamepad"></i> QUIZ TIME</h3>
                    <div class="quiz-question">
                        <p>What year was the Croton Dam completed?</p>
                        <div class="quiz-options">
                            <button class="quiz-option" onclick="selectQuizAnswer(2, 0)">1896</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(2, 1)">1906</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(2, 2)">1916</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(2, 3)">1926</button>
                        </div>
                        <div class="quiz-feedback" id="feedback-2"></div>
                    </div>
                `;
            } else if (stopIndex === 3) {
                gameContainer.innerHTML = `
                    <h3><i class="fas fa-gamepad"></i> QUIZ TIME</h3>
                    <div class="quiz-question">
                        <p>What year was the New York State Capitol building completed?</p>
                        <div class="quiz-options">
                            <button class="quiz-option" onclick="selectQuizAnswer(3, 0)">1889</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(3, 1)">1899</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(3, 2)">1909</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(3, 3)">1919</button>
                        </div>
                        <div class="quiz-feedback" id="feedback-3"></div>
                    </div>
                `;
            } else if (stopIndex === 4) {
                gameContainer.innerHTML = `
                    <h3><i class="fas fa-gamepad"></i> QUIZ TIME</h3>
                    <div class="quiz-question">
                        <p>In what year was Syracuse University founded?</p>
                        <div class="quiz-options">
                            <button class="quiz-option" onclick="selectQuizAnswer(4, 0)">1860</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(4, 1)">1870</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(4, 2)">1880</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(4, 3)">1890</button>
                        </div>
                        <div class="quiz-feedback" id="feedback-4"></div>
                    </div>
                `;
            } else if (stopIndex === 5) {
                gameContainer.innerHTML = `
                    <h3><i class="fas fa-gamepad"></i> QUIZ TIME</h3>
                    <div class="quiz-question">
                        <p>Why is Rochester known as the 'Flower City'?</p>
                        <div class="quiz-options">
                            <button class="quiz-option" onclick="selectQuizAnswer(5, 0)">It has many flower shops</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(5, 1)">It's famous for beautiful gardens</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(5, 2)">It's near botanical gardens</button>
                            <button class="quiz-option" onclick="selectQuizAnswer(5, 3)">All of the above</button>
                        </div>
                        <div class="quiz-feedback" id="feedback-5"></div>
                    </div>
                `;
            }
        }

        let memoryGameState = {
            0: {
                cards: ['NYC', 'ALB', 'SYR', 'ROC', 'NYC', 'ALB', 'SYR', 'ROC'],
                flipped: [],
                matched: [],
                moves: 0
            }
        };

        function initMemoryGame(stopId) {
            const state = memoryGameState[stopId];
            const grid = document.getElementById(`memory-grid-${stopId}`);
            if (grid) {
                const cards = grid.querySelectorAll('.memory-card');
                cards.forEach((card, index) => {
                    card.classList.remove('flipped', 'matched');
                    card.querySelector('span').textContent = '?';
                    card.disabled = false;
                });
            }
        }

        function flipCard(stopId, cardIndex) {
            const state = memoryGameState[stopId];
            
            if (state.flipped.includes(cardIndex) || state.matched.includes(cardIndex)) return;
            if (state.flipped.length === 2) return;

            state.flipped.push(cardIndex);
            const card = document.querySelectorAll(`#memory-grid-${stopId} .memory-card`)[cardIndex];
            card.classList.add('flipped');
            card.querySelector('span').textContent = state.cards[cardIndex];

            if (state.flipped.length === 2) {
                state.moves++;
                const [idx1, idx2] = state.flipped;

                if (state.cards[idx1] === state.cards[idx2]) {
                    state.matched.push(idx1, idx2);
                    document.querySelectorAll(`#memory-grid-${stopId} .memory-card`).forEach((c, i) => {
                        if (state.matched.includes(i)) {
                            c.classList.add('matched');
                            c.disabled = true;
                        }
                    });
                    state.flipped = [];

                    if (state.matched.length === state.cards.length) {
                        setTimeout(() => {
                            alert(`PERFECT! Completed in ${state.moves} moves!`);
                        }, 300);
                    }
                } else {
                    setTimeout(() => {
                        const cards = document.querySelectorAll(`#memory-grid-${stopId} .memory-card`);
                        cards[idx1].classList.remove('flipped');
                        cards[idx1].querySelector('span').textContent = '?';
                        cards[idx2].classList.remove('flipped');
                        cards[idx2].querySelector('span').textContent = '?';
                        state.flipped = [];
                    }, 1000);
                }
            }
        }

        function resetMemoryGame(stopId) {
            memoryGameState[stopId] = {
                cards: ['NYC', 'ALB', 'SYR', 'ROC', 'NYC', 'ALB', 'SYR', 'ROC'],
                flipped: [],
                matched: [],
                moves: 0
            };
            initMemoryGame(stopId);
        }

        function selectQuizAnswer(stopId, optionIndex) {
            const correctAnswers = {
                1: 1,
                2: 1,
                3: 1,
                4: 1,
                5: 1
            };

            const feedbackDiv = document.getElementById(`feedback-${stopId}`);
            const options = document.querySelectorAll(`#game-${stopId} .quiz-option`);

            options.forEach(opt => opt.disabled = true);
            options[optionIndex].classList.add('selected');

            feedbackDiv.classList.add('show');

            if (optionIndex === correctAnswers[stopId]) {
                options[optionIndex].classList.remove('selected');
                options[optionIndex].classList.add('correct');
                feedbackDiv.classList.add('correct');
                feedbackDiv.textContent = '✓ CORRECT!';
            } else {
                options[optionIndex].classList.remove('selected');
                options[optionIndex].classList.add('incorrect');
                options[correctAnswers[stopId]].classList.add('correct');
                feedbackDiv.classList.add('incorrect');
                feedbackDiv.textContent = '✗ INCORRECT! The correct answer was highlighted.';
            }
        }

        function showCompletionMessage() {
            const container = document.getElementById('completionContainer');
            container.innerHTML = `
                <div class="completion-message show">
                    <h2><i class="fas fa-check-circle"></i> JOURNEY COMPLETE!</h2>
                    <p>You've successfully traveled from Penn Station to Rochester!</p>
                    <p>Total Distance: 390 miles | Stops Visited: 6</p>
                    <div class="stats-display">
                        <div class="stat-item">
                            <div class="stat-value">6</div>
                            <div class="stat-label">STOPS VISITED</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">5</div>
                            <div class="stat-label">GAMES COMPLETED</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">∞</div>
                            <div class="stat-label">MEMORIES MADE</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function hideCompletionMessage() {
            const container = document.getElementById('completionContainer');
            container.innerHTML = '';
        }

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', initializeJourney);
    </script>
</body>
</html>