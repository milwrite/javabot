<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The River Riddle - Bot Sportello</title>
    <link rel="stylesheet" href="../page-theme.css">
    <style>
        body {
            padding: 80px 20px 20px 20px;
            background: #0a0a0a;
            color: #7ec8e3;
            font-family: 'Courier Prime', monospace;
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .riddle-section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            margin-bottom: 100px;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .riddle-section.revealed {
            opacity: 1;
            transform: translateY(0);
        }

        .riddle-text {
            font-size: 1.5rem;
            line-height: 1.8;
            margin-bottom: 2rem;
            text-align: center;
            color: #00ffff;
        }

        .answer-container {
            margin-top: 2rem;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
            transition: opacity 0.5s ease, max-height 0.5s ease;
        }

        .answer-container.show {
            opacity: 1;
            max-height: 500px;
        }

        .answer-input {
            width: 100%;
            max-width: 400px;
            padding: 15px;
            font-size: 1.1rem;
            background: #0a0a0a;
            border: 2px solid #7ec8e3;
            color: #00ffff;
            font-family: 'Courier Prime', monospace;
            text-align: center;
            margin: 0 auto;
            display: block;
            min-height: 44px;
        }

        .answer-input:focus {
            outline: none;
            border-color: #00ffff;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
        }

        .submit-btn {
            background: #ff0000;
            color: #0a0a0a;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-family: 'Courier Prime', monospace;
            cursor: pointer;
            margin: 20px auto;
            display: block;
            min-width: 44px;
            min-height: 44px;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            background: #00ffff;
            transform: scale(1.05);
        }

        .submit-btn:active {
            transform: scale(0.95);
        }

        .feedback {
            text-align: center;
            font-size: 1.2rem;
            margin-top: 1rem;
            min-height: 30px;
        }

        .feedback.correct {
            color: #00ffff;
            animation: glow 0.5s ease-in-out;
        }

        .feedback.incorrect {
            color: #ff0000;
            animation: shake 0.5s ease-in-out;
        }

        .river-flow {
            text-align: center;
            font-size: 2rem;
            color: #7ec8e3;
            margin: 2rem 0;
            animation: flow 3s ease-in-out infinite;
        }

        .progress-indicator {
            position: fixed;
            top: 70px;
            right: 20px;
            font-size: 0.9rem;
            color: #7ec8e3;
            background: rgba(10, 10, 10, 0.9);
            padding: 10px 15px;
            border: 1px solid #7ec8e3;
            z-index: 100;
        }

        .intro-section {
            text-align: center;
            margin-bottom: 100px;
            padding: 2rem 0;
        }

        .intro-section h1 {
            color: #00ffff;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .intro-section p {
            color: #7ec8e3;
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
        }

        .completion-section {
            text-align: center;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .completion-section.revealed {
            opacity: 1;
            transform: translateY(0);
        }

        .completion-section h2 {
            color: #00ffff;
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .reset-btn {
            background: #7ec8e3;
            color: #0a0a0a;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-family: 'Courier Prime', monospace;
            cursor: pointer;
            margin: 20px auto;
            display: block;
            min-width: 44px;
            min-height: 44px;
            transition: all 0.3s ease;
        }

        .reset-btn:hover {
            background: #00ffff;
            transform: scale(1.05);
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 5px #00ffff; }
            50% { text-shadow: 0 0 20px #00ffff; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        @keyframes flow {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(10px); }
        }

        @media (max-width: 768px) {
            .riddle-text {
                font-size: 1.2rem;
            }

            .intro-section h1 {
                font-size: 2rem;
            }

            .intro-section p {
                font-size: 1rem;
            }

            .answer-input {
                font-size: 1rem;
                padding: 12px;
            }

            .submit-btn {
                padding: 12px 30px;
                font-size: 1rem;
            }

            .progress-indicator {
                font-size: 0.8rem;
                padding: 8px 12px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 80px 15px 15px 15px;
            }

            .riddle-text {
                font-size: 1.1rem;
            }

            .intro-section h1 {
                font-size: 1.5rem;
            }

            .river-flow {
                font-size: 1.5rem;
            }

            .progress-indicator {
                top: 65px;
                right: 10px;
            }
        }
    </style>
</head>
<body>
    <nav class="home-link">
        <a href="../index.html">← Back to Collection</a>
    </nav>

    <div class="progress-indicator">
        <span id="progress">Riddle 0/5</span>
    </div>

    <div class="container">
        <div class="intro-section">
            <h1>The River Riddle</h1>
            <p>A mysterious river flows through the city. To cross it, you must answer five riddles. Each answer unlocks the next passage. Scroll down to begin your journey.</p>
            <div class="river-flow">~~~</div>
        </div>

        <div class="riddle-section" data-riddle="1">
            <div class="riddle-text">
                I speak without a mouth and hear without ears.<br>
                I have no body, but I come alive with wind.<br>
                What am I?
            </div>
            <div class="answer-container">
                <input type="text" class="answer-input" placeholder="Type your answer..." data-answer="echo">
                <button class="submit-btn">Submit Answer</button>
                <div class="feedback"></div>
            </div>
        </div>

        <div class="river-flow">~~~</div>

        <div class="riddle-section" data-riddle="2">
            <div class="riddle-text">
                The more you take, the more you leave behind.<br>
                What are they?
            </div>
            <div class="answer-container">
                <input type="text" class="answer-input" placeholder="Type your answer..." data-answer="footsteps">
                <button class="submit-btn">Submit Answer</button>
                <div class="feedback"></div>
            </div>
        </div>

        <div class="river-flow">~~~</div>

        <div class="riddle-section" data-riddle="3">
            <div class="riddle-text">
                I have cities, but no houses.<br>
                I have mountains, but no trees.<br>
                I have water, but no fish.<br>
                What am I?
            </div>
            <div class="answer-container">
                <input type="text" class="answer-input" placeholder="Type your answer..." data-answer="map">
                <button class="submit-btn">Submit Answer</button>
                <div class="feedback"></div>
            </div>
        </div>

        <div class="river-flow">~~~</div>

        <div class="riddle-section" data-riddle="4">
            <div class="riddle-text">
                What can travel around the world while staying in a corner?
            </div>
            <div class="answer-container">
                <input type="text" class="answer-input" placeholder="Type your answer..." data-answer="stamp">
                <button class="submit-btn">Submit Answer</button>
                <div class="feedback"></div>
            </div>
        </div>

        <div class="river-flow">~~~</div>

        <div class="riddle-section" data-riddle="5">
            <div class="riddle-text">
                I am not alive, but I grow.<br>
                I don't have lungs, but I need air.<br>
                I don't have a mouth, but water kills me.<br>
                What am I?
            </div>
            <div class="answer-container">
                <input type="text" class="answer-input" placeholder="Type your answer..." data-answer="fire">
                <button class="submit-btn">Submit Answer</button>
                <div class="feedback"></div>
            </div>
        </div>

        <div class="river-flow">~~~</div>

        <div class="completion-section">
            <h2>You have crossed the river.</h2>
            <p style="color: #7ec8e3; font-size: 1.2rem; margin: 1rem 0;">
                The waters part for those who seek truth.<br>
                The journey continues on the other shore.
            </p>
            <button class="reset-btn">Cross Again</button>
        </div>
    </div>

    <script>
        const riddleSections = document.querySelectorAll('.riddle-section');
        const completionSection = document.querySelector('.completion-section');
        const progressDisplay = document.getElementById('progress');
        const resetBtn = document.querySelector('.reset-btn');
        
        let solvedCount = 0;
        const totalRiddles = riddleSections.length;

        const observerOptions = {
            threshold: 0.3,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('revealed');
                    
                    const answerContainer = entry.target.querySelector('.answer-container');
                    if (answerContainer && !answerContainer.classList.contains('show')) {
                        setTimeout(() => {
                            answerContainer.classList.add('show');
                        }, 500);
                    }
                }
            });
        }, observerOptions);

        riddleSections.forEach(section => {
            observer.observe(section);
            
            const submitBtn = section.querySelector('.submit-btn');
            const input = section.querySelector('.answer-input');
            const feedback = section.querySelector('.feedback');
            const correctAnswer = input.dataset.answer;
            
            const checkAnswer = () => {
                const userAnswer = input.value.trim().toLowerCase();
                
                if (!userAnswer) {
                    feedback.textContent = 'Please enter an answer';
                    feedback.className = 'feedback incorrect';
                    return;
                }
                
                if (userAnswer === correctAnswer) {
                    feedback.textContent = '✓ Correct! The river flows onward...';
                    feedback.className = 'feedback correct';
                    input.disabled = true;
                    submitBtn.disabled = true;
                    submitBtn.style.opacity = '0.5';
                    
                    solvedCount++;
                    updateProgress();
                    
                    setTimeout(() => {
                        const nextSection = section.nextElementSibling;
                        if (nextSection && nextSection.classList.contains('river-flow')) {
                            const afterNext = nextSection.nextElementSibling;
                            if (afterNext) {
                                afterNext.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        }
                    }, 1500);
                    
                    if (solvedCount === totalRiddles) {
                        setTimeout(() => {
                            completionSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            observer.observe(completionSection);
                        }, 2000);
                    }
                } else {
                    feedback.textContent = '✗ Not quite. Try again...';
                    feedback.className = 'feedback incorrect';
                }
            };
            
            submitBtn.addEventListener('click', checkAnswer);
            
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    checkAnswer();
                }
            });
        });

        function updateProgress() {
            progressDisplay.textContent = `Riddle ${solvedCount}/${totalRiddles}`;
            
            if (solvedCount === totalRiddles) {
                setTimeout(() => {
                    progressDisplay.textContent = 'Journey Complete';
                }, 2000);
            }
        }

        resetBtn.addEventListener('click', () => {
            solvedCount = 0;
            updateProgress();
            
            riddleSections.forEach(section => {
                section.classList.remove('revealed');
                const answerContainer = section.querySelector('.answer-container');
                const input = section.querySelector('.answer-input');
                const submitBtn = section.querySelector('.submit-btn');
                const feedback = section.querySelector('.feedback');
                
                answerContainer.classList.remove('show');
                input.value = '';
                input.disabled = false;
                submitBtn.disabled = false;
                submitBtn.style.opacity = '1';
                feedback.textContent = '';
                feedback.className = 'feedback';
            });
            
            completionSection.classList.remove('revealed');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        updateProgress();
    </script>
</body>
</html>